#!/bin/bash

is_done=/etc/gem-first-init.isdone

if [ -f $is_done ]; then
    exit 0
fi

if [ "$EUID" -ne 0 ]
    then echo "Please run as root"
    exit
fi

list=(
    "sys-kernel-debug.mount"
    "sys-kernel-tracing.mount"
    "apt-daily.service"
    "apt-daily.timer"
    "apt-daily-upgrade.service"
    "apt-daily-upgrade.timer"
    "dpkg-db-backup.timer"
)

for i in "${list[@]}"; do
    systemctl stop "$i"
    systemctl disable "$i"
done

systemctl disable gem-first-init.service
echo "$(date)" > $is_done
exit 0
